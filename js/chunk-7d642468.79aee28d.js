(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7d642468"],{2831:function(t,e,i){i.r(e);i("f8b6");var n=i("36ad"),s=(i("6f0a"),i("bdaf")),a=(i("cdf1"),i("6eef")),o=i("1b70"),r=i("303c"),p=i("5054"),d=i("5b8b"),l=i("e45c"),s={components:{[s.a.name]:s.a},props:{apy:String|Number},data(){return{showOptions:!1,optioned:"HJZ",inquiring:!1,approving:!1,dealing:!1,options:["HJZ"],balancePIN:0,allowancePIN:0,balanceHJZ:0,allowanceHJZ:0,pinAmount:"",communityTokenAmount:"",getPower:0,records:[],CommunityExample:null,pinQuota:0}},computed:{...Object(a.b)(["isConnected","web3","address"]),communityToken(){return{logoURI:i("480f"),address:d.address,balance:this.balanceHJZ,allowance:this.allowanceHJZ}},isPINApproved(){return this.pinAmount<=0||this.pinAmount.toBN().lte(this.allowancePIN)},isCommunityTokenApproved(){return this.communityTokenAmount<=0||this.communityTokenAmount.toBN().lte(this.communityToken.allowance)},btnText(){return this.approving?this.$t("approving"):this.dealing?this.$t("dealing"):this.isPINApproved?this.isCommunityTokenApproved?this.$t("HJZCommunity.text13"):this.$t("approve_token",{symbol:this.optioned}):this.$t("approve_token",{symbol:"PIN"})},btnDisabled(){return this.approving||this.dealing||this.inquiring||this.pinAmount<=0||this.balancePIN.toBN().lt(this.pinAmount)||this.communityToken.balance.toBN().lt(this.communityTokenAmount)}},created(){this.isConnected&&(this.CommunityExample=new this.web3.eth.Contract(r.abi,r.address),this.init())},methods:{selectToken(t){t===this.optioned||(this.pinAmount="",this.communityTokenAmount="",this.getPower=0,this.optioned=t),this.showOptions=!1},input(){if(!this.inquiring)if(this.pinAmount<=0)this.getPower=0,this.communityTokenAmount="";else{this.inquiring=!0;let e=setTimeout(async()=>{if(this.pinAmount<=0)return this.getPower=0,this.communityTokenAmount="",this.inquiring=!1,clearTimeout(e);var t=await this.CommunityExample.methods.convertInfo(this.communityToken.address,this.pinAmount.toWei()).call();this.getPower=t.power,this.communityTokenAmount=t.amount2.fromWei(),this.inquiring=!1,clearTimeout(e)},1e3)}},approve(){this.approving=!0;var t=(this.isPINApproved?this.communityToken:p).address;let n=new this.web3.eth.Contract(p.abi,t);n.methods.approve(r.address,"100000000".toWei()).send({from:this.address}).on("receipt",async t=>{var e=await n.methods.allowance(this.address,r.address).call();this.isPINApproved?this["allowance"+this.optioned]=e.fromWei():this.allowancePIN=e.fromWei(),this.isPINApproved&&this.isCommunityTokenApproved?this.convert():this.approve(),this.approving=!1}).on("error",t=>{this.approving=!1})},async convert(){if(!this.isPINApproved||!this.isCommunityTokenApproved)return this.approve();if(this.pinQuota.lt(this.pinAmount))return n.a.fail(this.$t("HJZCommunity.text17"));this.dealing=!0;var t=Math.floor(+new Date/1e3),t=this.CommunityExample.methods.convert(this.communityToken.address,this.pinAmount.toWei(),t+600,this.address);try{await t.call({from:this.address}),t.send({from:this.address}).on("receipt",t=>{n.a.success(this.$t("successful_transaction")),this.$emit("refreshData"),this.pinAmount="",this.communityTokenAmount="",this.getPower=0,this.dealing=!1}).on("error",t=>{this.dealing=!1})}catch(t){t.message.includes("to less")&&n.a.fail(this.$t("burn_worth_tip")),this.dealing=!1}},init(){var t=new this.web3.eth.Contract(p.abi,p.address),e=new this.web3.eth.Contract(d.abi,d.address);t.methods.balanceOf(this.address).call((t,e)=>{t||(this.balancePIN=e.fromWei())}),t.methods.allowance(this.address,r.address).call((t,e)=>{t||(this.allowancePIN=e.fromWei())}),e.methods.balanceOf(this.address).call((t,e)=>{t||(this.balanceHJZ=e.fromWei())}),e.methods.allowance(this.address,r.address).call((t,e)=>{t||(this.allowanceHJZ=e.fromWei())}),this.CommunityExample.methods.myQuota().call({from:this.address},async(t,e)=>{t||(t=await this.$Router.methods.getAmountsOut("1".toWei(),[l.address,p.address]).call(),this.pinQuota=t[1].toBN().times(e).div(1e36).div(2))}),Object(o.b)(this.address).then(async e=>{var n=[];for(let t=0;t<e.length;t++){var s=new this.web3.eth.Contract(p.abi,e[t].token),i=await s.methods.symbol().call(),s=await s.methods.decimals().call();n.push({power:e[t].power,pinAmount:e[t].pinAmount.fromWei(),tokenAmount:e[t].tokenAmount.fromWei(s),tokenSymbol:i,hash:e[t].id.slice(0,e[t].id.indexOf("-")),date:this.$toTime(e[t].time,"Y/M/D H:i")})}this.records=n,this.$nextTick(()=>{this.$emit("reloadSwiper")})})}}},a=(i("722e"),i("6707")),a=Object(a.a)(s,function(){var n=this,s=n._self._c;n._self._setupProxy;return s("div",{staticClass:"dao"},[s("div",{staticClass:"content"},[s("div",{staticClass:"container"},[s("div",{staticClass:"title"},[s("span",[n._v(n._s(n.$t("dao_governs_mining")))]),s("span",[n._v(n._s(n.$t("dao_tips.tip1")))])]),s("div",{staticClass:"swap"},[s("div",{staticClass:"token"},[s("span",[n._v("PIN")]),s("span",[n._v(n._s(n.balancePIN.toFixed(2)))])]),s("div",{staticClass:"logo"},[s("img",{attrs:{src:i("f48e")}}),s("img",{attrs:{src:n.communityToken.logoURI}})]),s("div",{staticClass:"token"},[s("div",{staticClass:"select",on:{click:function(t){n.showOptions=!n.showOptions}}},[s("span",[n._v(n._s(n.optioned))]),s("img",{attrs:{src:i("8d7f")}})]),s("span",[n._v(n._s(n.communityToken.balance.toFixed(2)))]),s("div",{directives:[{name:"show",rawName:"v-show",value:n.showOptions,expression:"showOptions"}],staticClass:"options"},n._l(n.options,function(e){return s("span",{class:{active:n.optioned===e},on:{click:function(t){return n.selectToken(e)}}},[n._v(n._s(e))])}),0)])]),s("div",{staticClass:"input-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:n.pinAmount,expression:"pinAmount"}],attrs:{type:"number",placeholder:"0"},domProps:{value:n.pinAmount},on:{input:[function(t){t.target.composing||(n.pinAmount=t.target.value)},n.input]}}),s("img",{attrs:{src:i("85e0")}}),s("input",{attrs:{type:"number",placeholder:"0",readonly:""},domProps:{value:n.communityTokenAmount}})]),s("div",{staticClass:"get-power"},[s("span",[n._v(n._s(n.$t("HJZCommunity.text5")))]),s("span",[n._v(n._s(n.getPower))])]),s("van-button",{attrs:{disabled:n.btnDisabled,loading:n.approving||n.dealing,"loading-text":n.btnText},on:{click:n.convert}},[n._v(n._s(n.btnText))])],1)]),s("div",{staticClass:"record-title"},[n._v(n._s(n.$t("last_record")))]),n._l(n.records,function(t){return s("div",{staticClass:"record-container"},[s("div",{staticClass:"record-main"},[s("div",{staticClass:"status"},[s("span",{staticClass:"success"},[n._v(n._s(n.$t("success")))]),s("span",[n._v(n._s(t.date))])]),s("div",{staticClass:"amount"},[s("span",[n._v("+"+n._s(t.power))]),s("span",[n._v(n._s(n.$t("power")))])]),s("a",{staticClass:"details",attrs:{target:"_blank",href:"https://bscscan.com/tx/"+t.hash}},[s("div",{staticClass:"tokens"},[s("div",[s("span",[n._v("PIN")]),s("span",[n._v("-"+n._s(t.pinAmount.toFixed(4)))])]),s("div",[s("span",[n._v(n._s(t.tokenSymbol))]),s("span",[n._v("-"+n._s(t.tokenAmount.toFixed(4)))])])]),s("div",{staticClass:"check"},[s("span",[n._v(n._s(n.$t("check")))]),s("van-icon",{attrs:{name:"arrow"}})],1)])])])}),s("div",{directives:[{name:"show",rawName:"v-show",value:!n.records.length,expression:"!records.length"}],staticClass:"record-empty"},[s("img",{attrs:{src:i("d5e6")}}),s("span",[n._v(n._s(n.$t("no_latest_transaction")))])])],2)},[],!1,null,"078f5aae",null);e.default=a.exports},"5b8b":function(t){t.exports=JSON.parse('{"abi":[{"inputs":[{"internalType":"address","name":"_recipient","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"burnFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}],"address":"0xd0EF020D21B68f3aeb66A705522ccf19210dC220"}')},"722e":function(t,e,n){n("d070")},d070:function(t,e,n){}}]);