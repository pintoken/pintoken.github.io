(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Computingpower"],{4891:function(t,e,n){"use strict";n("6557")},"5f4b":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Computingpower"},[n("div",{staticClass:"title"},[n("div",{staticClass:"head"},[n("span",[t._v(t._s(t.$t("Computingpower.text1")))])]),n("div",{staticClass:"middle"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.quantitys,expression:"quantitys"}],attrs:{placeholder:t.$t("Computingpower.text3"),type:"text"},domProps:{value:t.quantitys},on:{input:[function(e){e.target.composing||(t.quantitys=e.target.value)},t.input]}}),n("van-button",{on:{click:t.maximum}},[t._v(t._s(t.$t("Computingpower.text4")))])],1),n("div",{staticClass:"power"},[n("span",[t._v(t._s(t.$t("Computingpower.text2")))]),n("span",[t._v(t._s(t.myPower))])]),n("div",{staticClass:"takeover"},[t._v(t._s(t.$t("Computingpower.text7")))]),n("div",{staticClass:"bottom"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.acceptaddress,expression:"acceptaddress"}],attrs:{placeholder:t.$t("Computingpower.text8"),type:"text",name:"",id:""},domProps:{value:t.acceptaddress},on:{input:function(e){e.target.composing||(t.acceptaddress=e.target.value)}}})]),n("div",{staticClass:"getComputingpower"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isshow,expression:"isshow"}],staticClass:"Transferout"},[t._v(" "+t._s(t.$t("Computingpower.text5"))+" "),n("span",[t._v("1%")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isshow,expression:"!isshow"}],staticClass:"getComputingpower1"},[n("span",[t._v(t._s(t.$t("Computingpower.text6")))]),n("span",[t._v(t._s(t.Available))])])]),n("van-button",{on:{click:t.Transferout}},[t._v(t._s(t.$t("Computingpower.text9")))])],1),n("div",{staticClass:"Detail"},[t._v(t._s(t.$t("Computingpower.text10")))]),n("div",{staticClass:"record"},[n("div",{staticClass:"content1"},[n("div",[n("span",[t._v(t._s(t.$t("Computingpower.text11")))]),n("span",[t._v(t._s(t.$t("Computingpower.text12")))]),n("span",[t._v(t._s(t.$t("Computingpower.text13")))])]),t._l(t.list,(function(e){return n("div",{key:e},[n("span",[t._v(t._s(e.time))]),n("span",[t._v(t._s(e.type))]),n("span",{staticClass:"blue"},[t._v(t._s(e.amount))])])}))],2)])])},a=[],r=(n("99af"),n("a9e3"),n("96cf"),n("1da1")),i={data:function(){return{show:!0,isshow:!0,quantitys:"",myPower:0,Available:0,acceptaddress:"",list:[],size:20,offset:0,Transferoutlist:[],isStart:!1}},created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=new t.$web3.BatchRequest,n.add(t.$contracts.Mine.methods.isStart().call.request({from:t.$address})),n.add(t.$contracts.Mine.methods.mineInfo().call.request({from:t.$address})),n.add(t.$contracts.Pledge.methods.getMinerInfo(0).call.request({from:t.$address})),n.add(t.$contracts.Shareholders.methods.pledgeInfo(t.$address).call.request({from:t.$address})),n.requestManager.sendBatch(n.requests,(function(e,n){if(!e){var s=n[1].result.decode([{name:"myPower",type:"uint256"},{name:"mined",type:"uint256"}]),a=s.myPower,r=n[2].result.decode([{name:"pledgeLp",type:"uint256"},{name:"gainPower",type:"uint256"}]),i=r.gainPower,o=n[3].result.decode([{name:"lpAmount",type:"uint256"},{name:"totalPower",type:"uint256"},{name:"lpAmountPerUSD",type:"uint256"},{name:"lpAmountPerPIN",type:"uint256"}]),u=o.totalPower;t.isStart=("string"===typeof n[0]?n[0]:n[0].result).decode(["bool"]),t.myPower=Number(a)-Number(i)-Number(u)}})),t.getRecord();case 7:case"end":return e.stop()}}),e)})))()},getRecord:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[t.$t("Computingpower.text14"),t.$t("Computingpower.text15"),t.$t("Computingpower.text16"),t.$t("Computingpower.text17"),t.$t("Computingpower.text18"),t.$t("Computingpower.text19"),t.$t("Computingpower.text26"),t.$t("Computingpower.text27")],t.list=[],e.t0=t.$contracts.Mine.events,e.next=5,t.$web3.eth.getBlockNumber();case 5:e.t1=e.sent,e.t2=e.t1-4999,e.t3={owner:t.$address},e.t4={fromBlock:e.t2,filter:e.t3},e.t0.PowerEvent.call(e.t0,e.t4).on("data",(function(e){var s=e.returnValues,a=s.isAdd,r=s.powerSource,i=s.amount,o=s.time;2==e.returnValues.powerSource?t.list.unshift({time:t.$toTime(o,"Y/M/D"),type:a?n[r]:t.$t("Computingpower.text20"),amount:"".concat(a?"+":"-").concat(i)}):t.list.unshift({time:t.$toTime(o,"Y/M/D"),type:n[r],amount:"".concat(a?"+":"-").concat(i)})}));case 10:case"end":return e.stop()}}),e)})))()},maximum:function(){this.quantitys=this.myPower,this.input()},input:function(){var t=parseInt(this.quantitys,10);t!=this.quantitys?(this.quantitys="",this.isshow=!0):null!=this.quantitys&&(this.isshow=!1),this.Available=Math.floor(.99*this.quantitys)},Transferout:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isStart){e.next=4;break}return e.abrupt("return",vant.Toast.fail("合约暂未生效！"));case 4:if(!(Number(t.quantitys)<=0)){e.next=8;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text21")));case 8:if(!(Number(t.quantitys)>Number(t.myPower))){e.next=12;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text22")));case 12:if(t.$web3.utils.isAddress(t.acceptaddress)){e.next=14;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text23")));case 14:n=t.$contracts.Mine.methods.transfer(t.acceptaddress,t.quantitys),n.call({from:t.$address},(function(e,s){e||n.send({from:t.$address}).on("transactionHash",(function(e){vant.Toast.loading({message:t.$t("transaction.text7"),forbidClick:!0,duration:0,loadingType:"spinner"})})).on("receipt",(function(e){vant.Toast.clear(),t.acceptaddress="",t.quantitys="",t.isshow=!0,vant.Toast.success(t.$t("Computingpower.text25"))})).on("error",(function(e){vant.Toast.clear(),vant.Toast.fail(t.$t("transaction.text13"))}))}));case 16:case"end":return e.stop()}}),e)})))()}}},o=i,u=o,c=(n("4891"),n("2877")),p=Object(c["a"])(u,s,a,!1,null,"dabed030",null);e["default"]=p.exports},6557:function(t,e,n){}}]);