(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e774176"],{"04a7":function(e,t,n){n("efcb")},"9f11":function(e,t,n){n.r(t);var a=[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"suffix"},[t("img",{attrs:{src:n("41a2"),alt:"pinswap"}}),t("span",[e._v("PIN")])])}],i=(n("f8b6"),n("36ad")),s=n("6eef"),p=n("ba07"),r=n("ab08");let u={components:{"order-item":()=>n.e("chunk-ffb43350").then(n.bind(null,"89c4")),"no-order":()=>n.e("chunk-3d0125e0").then(n.bind(null,"cd88"))},data(){return{PinPledgeExample:null,amount:"",balance:0,allowance:0,plans:[],plansIndex:0,order:null,isTrading:!1,isApproving:!1}},computed:{...Object(s.b)(["isConnected","web3","address"]),btnText(){var e=this.amount.toBN();return this.isTrading?this.$t("confirming"):this.isApproving?this.$t("approving"):e.lt(10)?this.$t("affirmative_tips.minimum_10Pin"):e.gt(this.balance)?this.$t("insufficient_balance"):e.gt(this.allowance)?this.$t("approve_token",{symbol:"PIN"}):this.$t("confirm")},isDisabled(){var e;return!(!this.isTrading&&!this.isApproving)||this.amount<=0||(e=this.amount.toBN()).lt(10)||e.gt(this.balance)}},created(){this.isConnected&&(this.PinTokenExample=new this.web3.eth.Contract(p.abi,p.address),this.PinPledgeExample=new this.web3.eth.Contract(r.abi,r.address),this.init())},methods:{allIn(){this.amount=this.balance},openOrderReward(e){this.$emit("openOrderReward",e)},openRemoveOrder(e){this.$emit("openRemoveOrder",e)},approve(){this.isApproving=!0,this.PinTokenExample.methods.approve(r.address,this.amount.toBN().times(10).toFixed().toWei()).send({from:this.address}).on("receipt",async()=>{var e=await this.PinTokenExample.methods.allowance(this.address,r.address).call();i.a.success(this.$t("approval_success")),this.allowance=e.fromWei(),this.isApproving=!1,this.deposit()}).on("error",e=>{this.isApproving=!1})},async deposit(){if(this.amount.toBN().gt(this.allowance))return this.approve();this.isTrading=!0;var e=this.PinPledgeExample.methods.depositPlan(this.plansIndex,this.amount.toWei());try{await e.call({from:this.address}),e.send({from:this.address}).on("receipt",()=>{this.init(),i.a.success(this.$t("participate_success")),this.amount="",this.isTrading=!1}).on("error",e=>{this.isTrading=!1})}catch(e){this.isTrading=!1}},init(){this.PinTokenExample.methods.balanceOf(this.address).call((e,t)=>{e||(this.balance=t.fromWei())}),this.PinPledgeExample.methods.plans().call((e,t)=>{e||(this.plans=t.map(e=>({...e,apy:e.apd.fromWei(12).toBN().times(100).times(365).toFixed()})))}),this.PinTokenExample.methods.allowance(this.address,r.address).call((e,t)=>{e||(this.allowance=t.fromWei())}),this.PinPledgeExample.methods.accountPlansOf(this.address).call(async(e,n)=>{if(!e&&0<n.length){var a=await this.web3.eth.getBlock("latest");let t=!0;for(let e=n.length-1;0<=e;e--)if(!n[e].isExpired){this.order={...n[e],id:e,blockTime:a.timestamp},t=!1;break}t&&(this.order={...n[n.length-1],id:n.length-1,blockTime:a.timestamp})}})}}},o=u,l=o,d=(n("04a7"),n("6707")),y=Object(d.a)(l,function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"data-validation"},[e("div",{staticClass:"form-bg"},[e("div",{staticClass:"form"},[e("div",{staticClass:"title"},[e("h3",[t._v(t._s(t.$t("affirmative")))]),e("span",[t._v(t._s(t.$t("affirmative_note")))])]),e("div",{staticClass:"content"},[e("div",{staticClass:"subtitle"},[e("label",{attrs:{for:"amount"}},[t._v(t._s(t.$t("join_affirmative")))]),e("span",[t._v("APY "),e("span",[t._v(t._s((t.plans[t.plansIndex]&&t.plans[t.plansIndex].apy||0).toFixed(2))+"%")])])]),e("div",{staticClass:"field"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{id:"amount",type:"number",placeholder:"0"},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),t._m(0)]),e("div",{staticClass:"balance"},[e("span",[t._v(t._s(t.$t("balance"))+" "+t._s(t.balance.toFixed(4)))]),e("van-button",{on:{click:t.allIn}},[t._v(t._s(t.$t("max")))])],1),e("div",{staticClass:"btn-group"},[e("van-button",{class:{active:0===t.plansIndex},on:{click:function(e){t.plansIndex=0}}},[t._v(t._s(t.$t("plans.one_day")))]),e("van-button",{class:{active:1===t.plansIndex},on:{click:function(e){t.plansIndex=1}}},[t._v(t._s(t.$t("plans.one_year")))]),e("van-button",{class:{active:2===t.plansIndex},on:{click:function(e){t.plansIndex=2}}},[t._v(t._s(t.$t("plans.two_year")))]),e("van-button",{class:{active:3===t.plansIndex},on:{click:function(e){t.plansIndex=3}}},[t._v(t._s(t.$t("plans.three_year")))])],1),e("div",{staticClass:"tip"},[e("img",{attrs:{src:n("c625")}}),e("p",[t._v(t._s(t.$t("affirmative_tips.select_plan")))])]),e("van-button",{attrs:{disabled:t.isDisabled,loading:t.isTrading||t.isApproving,"loading-text":t.btnText},on:{click:t.deposit}},[t._v(t._s(t.btnText))])],1)])]),e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.$t("last_record")))]),e("router-link",{attrs:{to:"/order"}},[e("span",[t._v(t._s(t.$t("all_order")))]),e("img",{attrs:{src:n("c39f")}})])],1),t.order?e("order-item",{attrs:{info:t.order},on:{openOrderReward:t.openOrderReward,openRemoveOrder:t.openRemoveOrder}}):t._e(),e("no-order",{directives:[{name:"show",rawName:"v-show",value:!t.order,expression:"!order"}]})],1)},a,!1,null,"385f4bd7",null);t.default=y.exports},ab08:function(e){e.exports=JSON.parse('{"abi":[{"inputs":[],"name":"AccessControlBadConfirmation","type":"error"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"bytes32","name":"neededRole","type":"bytes32"}],"name":"AccessControlUnauthorizedAccount","type":"error"},{"inputs":[],"name":"InvalidInitialization","type":"error"},{"inputs":[],"name":"NotInitializing","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint64","name":"version","type":"uint64"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"uint256","name":"durationSec","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"apd","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"PlanDeposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":false,"internalType":"uint256","name":"planIndex","type":"uint256"}],"name":"PlanExpired","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":false,"internalType":"uint256","name":"planIndex","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"reward","type":"uint256"}],"name":"PlanWithdrawned","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"Redeemed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"previousAdminRole","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"newAdminRole","type":"bytes32"}],"name":"RoleAdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"sender","type":"address"}],"name":"RoleGranted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"sender","type":"address"}],"name":"RoleRevoked","type":"event"},{"inputs":[],"name":"DEFAULT_ADMIN_ROLE","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"DELEGATE_ROLE","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"MANAGER_ROLE","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"accountInfoOf","outputs":[{"internalType":"uint256","name":"totalPledged","type":"uint256"},{"internalType":"uint256","name":"totalRedeemed","type":"uint256"},{"internalType":"uint256","name":"lastRedeemedAt","type":"uint256"},{"internalType":"uint256","name":"redeemAmountSec","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"}],"name":"getRoleAdmin","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"grantRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"hasRole","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"planEntityOf","outputs":[{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"apd","type":"uint256"},{"internalType":"uint256","name":"paidAmount","type":"uint256"},{"internalType":"uint256","name":"totalTakedAmount","type":"uint256"},{"internalType":"uint256","name":"lastSettlementTime","type":"uint256"},{"internalType":"bool","name":"isExpired","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"callerConfirmation","type":"address"}],"name":"renounceRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"revokeRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"token","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"_token","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"durationSec","type":"uint256"}],"internalType":"struct ImportInfo[]","name":"infos","type":"tuple[]"}],"name":"importDatas","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"earned","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"redeem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"plans","outputs":[{"components":[{"internalType":"uint256","name":"durationSec","type":"uint256"},{"internalType":"uint256","name":"apd","type":"uint256"}],"internalType":"struct Plan[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"accountPlansOf","outputs":[{"components":[{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"apd","type":"uint256"},{"internalType":"uint256","name":"paidAmount","type":"uint256"},{"internalType":"uint256","name":"totalTakedAmount","type":"uint256"},{"internalType":"uint256","name":"lastSettlementTime","type":"uint256"},{"internalType":"bool","name":"isExpired","type":"bool"}],"internalType":"struct PlanEntity[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"planIndex","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"depositPlan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"planIndex","type":"uint256"}],"name":"earnedPlan","outputs":[{"internalType":"uint256","name":"reward","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"planIndex","type":"uint256"}],"name":"withdrawPlan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"planIndex","type":"uint256"}],"name":"withdrawPrincipal","outputs":[],"stateMutability":"nonpayable","type":"function"}],"address":"0xb54Cbbb64Dd8504D74361e1E4baf305e8498c5C9"}')},ba07:function(e){e.exports=JSON.parse('{"abi":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"allowance","type":"uint256"},{"internalType":"uint256","name":"needed","type":"uint256"}],"name":"ERC20InsufficientAllowance","type":"error"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"uint256","name":"balance","type":"uint256"},{"internalType":"uint256","name":"needed","type":"uint256"}],"name":"ERC20InsufficientBalance","type":"error"},{"inputs":[{"internalType":"address","name":"approver","type":"address"}],"name":"ERC20InvalidApprover","type":"error"},{"inputs":[{"internalType":"address","name":"receiver","type":"address"}],"name":"ERC20InvalidReceiver","type":"error"},{"inputs":[{"internalType":"address","name":"sender","type":"address"}],"name":"ERC20InvalidSender","type":"error"},{"inputs":[{"internalType":"address","name":"spender","type":"address"}],"name":"ERC20InvalidSpender","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"value","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"burnFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}],"address":"0xcAfEDA13f42B44e6E4A7B1fd9A79dee948868Fe7"}')},efcb:function(e,t,n){}}]);